<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc compact="yes"?>
<rfc category="std" docName="draft-ietf-dcrup-dkim-usage-03" ipr="trust200902" updates="6376">
 <front>
   <title abbrev="DKIM Crypto Usage Update">Cryptographic Algorithm and Key Usage Update to DKIM</title>

   <author initials="S." surname="Kitterman"
	   fullname="Scott Kitterman">
      <organization>Kitterman Technical Services</organization>

      <address>
	 <postal>
	    <street>3611 Scheel Dr</street>
	    <city>Ellicott City</city>
	    <region>MD</region>
	    <code>21042</code>
	 </postal>
	    
	 <phone>+1 301 325-5475</phone>
	 <email>scott@kitterman.com</email>
      </address>
   </author>

   <date month="June" year="2017" />

   <abstract>
     <t>The cryptographic algorithm and key size requirements included when DKIM
     was designed in the last decade are functionally obsolete and in need of
     immediate revision.  This document updates DKIM requirements to those
     minimaly suitable for operation with currently specified algorithms.  This
     document updates RFC 6376.</t>
   </abstract>
 </front>

 <middle>
   <section anchor="intro" title="Introduction">
      <t><list style="hanging">
          <t hangText="Discussion Venue:  ">Discussion about this draft is directed to the
          <eref target="mailto:dcrup@ietf.org">dcrup@ietf.org</eref> mailing list.</t>
	 </list></t>
     <t><xref target="RFC6376">DKIM</xref> signs e-mail messages, by creating hashes of the message
	headers and content and signing the header hash with a digital signature.
	Message recipients fetch the signature verification key from the DNS where it is
	stored in a TXT record.
     </t>
     <t>
	The defining documents specify a single signing algorithm, <xref target="RFC8017">RSA</xref>,
	and recommends key sizes of 1024 to 2048 bits (but require verification of 512 bit keys).
        As discussed in <xref target="VULNOTE">US-CERT VU#268267</xref>, the operational
        community has recognized that shorter keys compromise the effectiveness of DKIM.
	While 1024 bit signatures are common, stronger signatures are not.  Widely used DNS
        configuration software places a practical limit on key sizes, because the software only
        handles a single 256 octet string in a TXT record, and RSA keys longer than 1024 bits don't
        fit in 256 octets.
     </t>
   </section>
   
   <section title="Conventions Used in This Document">
     <t>The capitalized key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
	"RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
	<xref target="RFC2119" />.</t>
   </section>

   <section title="DKIM Signing and Verification Algorithms">
     <t><xref target="RFC6376">DKIM</xref> defines two signature algorithms:
     rsa-sha1 and rsa-sha256.  This document updates RFC 6376 in two ways:

     <list style="numbers">
       <t>DKIM implementations MUST implement the rsa-sha256 algorithm.  Signers
       MUST use the rsa-sha256 algorithm.</t>

       <t>Verifiers MUST NOT rely on the rsa-sha1 algorithm.</t>
     </list>
     </t>
   </section>

   <section title="Security Considerations">
      <t> This document does not change the Security Considerations of <xref
      target="RFC6376"/>.  It reduces the risk of signature compromise due to
      weak cryptography.  The SHA-1 risks discussed in Section 3 of <xref
      target="RFC6194"/> are no longer relevant once a stronger algorithm is
      available.</t>
   </section>

   <section title="IANA Considerations">
     <t>IANA is requested to update the "sha1" registration in the "DKIM Hash
        Algorithms" as follows:</t>
      <texttable anchor="dkimhashtag"
                 title="DKIM Hash Algorithms Changed Value">
        <ttcol align="center">TYPE</ttcol>
        <ttcol align="left">REFERENCE</ttcol>
        <ttcol align="left">STATUS</ttcol>

        <c>sha1</c>
        <c>(this document)</c>
        <c>obsolete</c>
      </texttable>
   </section>
 </middle>

 <back>
   <references title="Normative References">
      <?rfc include="reference.RFC.2119" ?>
      <?rfc include="reference.RFC.3766" ?>
      <?rfc include="reference.RFC.6376" ?>
      <?rfc include="reference.RFC.8017" ?>
   </references>
   <references title="Informative References">
      <reference anchor="VULNOTE">
         <front>
            <title>Vulnerability Note VU#268267, DomainKeys Identified Mail (DKIM) Verifiers may inappropriately convey message trust</title>
            <author>
               <organization>US-CERT</organization>
            </author>
            <date day="24" month="October" year="2012" />
         </front>
         <format type="HTML" target="http://www.kb.cert.org/vuls/id/268267"/>
      </reference>
      <?rfc include="reference.RFC.6194" ?>
   </references>
   <section anchor="thanks" title="Acknowledgements">
      <t> The author wishes to acknowledge the following for their
      review and comment on this proposal:
      Kurt Andersen, Murray S. Kucherawy, Martin Thomson, John Levine,
      Russ Housley, and Jim Fenton. </t>
      <t> Thanks to John Levine for draft-ietf-dcrup-dkim-crypto-00, which was
          the source for much of the introductory material in this draft. </t>
    </section>
 </back>
</rfc>
